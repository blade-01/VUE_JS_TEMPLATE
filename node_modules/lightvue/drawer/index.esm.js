import{trueValueMixin as e,preventBrowserBackMixin as t}from"lightvue/mixins";import{openBlock as r,createBlock as n,createVNode as i,withModifiers as o,createCommentVNode as a,toDisplayString as h,renderSlot as d}from"vue";var s={name:"LvDrawer",mixins:[e,t],data:()=>({initialTouch:0,currentTouch:0,changedTouch:0,initialClientYTouch:0,isMoving:!1,isMobile:!1,snap:0,drawerHeight:0,windowWidth:0,windowHeight:0,containerHeight:0,timeOutID:null}),props:{top:Boolean,right:Boolean,bottom:Boolean,left:Boolean,close:Boolean,shadow:Boolean,backdropBlur:Boolean,customStyle:Object,headerTitle:String,backdropOpacity:{type:Number,default:.3},absolute:{type:Boolean,default:!1},noBackdrop:{type:Boolean,default:!1},width:{type:Number,default:250},height:{type:Number,default:250},percentWidth:Number,percentHeight:Number,zIndex:{type:Number,default:10},maxSpan:{type:Number,default:70},background:{type:String,default:"#ffffff"},headerColor:{type:String,default:"#000000"},headerBackground:{type:String,default:"#fff"},headerFontSize:{type:String,default:"20px"},padding:{type:String,default:"0px"},noBottom:{type:Boolean,default:!1}},methods:{drawerClose(){this.snap=this.drawerHeight,this.$emit("close"),this.updateValue(!1)},handleTouchStart(e){this.initialTouch=this.$refs.drawer.offsetTop,this.initialClientYTouch=e.touches[0].clientY,this.currentTouch=0,this.changedTouch=0,this.isMoving=!0},handleTouchMove(e){this.isMoving&&(this.currentTouch=e.touches[0].clientY,this.changedTouch=this.initialClientYTouch-this.currentTouch)},handleTouchEnd(){this.getSnap(this.getTopPx),this.isMoving=!1,this.initialTouch=0,this.initialClientYTouch=0,this.currentTouch=0,this.changedTouch=0},getSnap(e){const t=10*this.containerHeight/100,r=this.containerHeight*(100-this.maxSpan)/100;e<=r?this.snap=r.toString()+"px":e>this.containerHeight-t?(this.snap="100%",this.drawerClose()):this.snap=e},handleResize(){this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,this.isMobile=this.windowWidth<=525,clearTimeout(this.timeOutID),this.timeOutID=setTimeout((()=>{this.drawerHeight=this.getHeight,this.snap=this.drawerHeight}),250)},handleOnBrowserBack(){!0===this.modelValue&&this.drawerClose()}},computed:{getTopPx(){return this.initialTouch-this.changedTouch},getDrawerStyle(){return{width:this.left||this.right?this.getWidth:this.top||this.right?"100%":this.getWidth,zIndex:this.zIndex+5,padding:this.padding,background:this.background,...this.getTransitionStyle,...this.customStyle}},getHeaderStyle(){return{fontSize:this.headerFontSize,color:this.headerColor,background:this.headerBackground}},getTransitionStyle(){return this.getDrawerPosition?this.getBottomTouchStyle:this.left?this.getLeftStyle:this.right?this.getRightStyle:this.top?this.getTopStyle:this.getLeftStyle},getLeftStyle(){return{left:0,top:0,bottom:0,transform:this.modelValue?"translateX(0)":"translateX(-100%)"}},getRightStyle(){return{right:0,top:0,bottom:0,left:"100%",transform:this.modelValue?"translateX(-100%)":"translateX(0)"}},getTopStyle(){return{left:0,right:0,top:0,bottom:this.modelValue?this.drawerHeight:"100%"}},getBottomTouchStyle(){return{left:0,right:0,bottom:0,width:"100%",height:"auto",top:this.modelValue?this.isMoving?this.getTopPx+"px":this.snap:"100%"}},getDrawerPosition(){return!this.noBottom&&this.isMobile},getHeight(){this.containerHeight=this.$refs.drawerWrapper.clientHeight;let e=0;return this.percentHeight?(this.percentHeight,this.windowHeight):e=Math.min(this.height,this.windowHeight),this.containerHeight-e+"px"},getWidth(){return this.percentWidth?`${this.percentWidth}%`:`${this.width}px`}},watch:{modelValue(e){document.documentElement.style.overflow=1==e?this.noBackdrop?"auto":"hidden":"overlay",!0===e?this.preventPopstate():this.manuallyClosePopstate()}},beforeMount(){this.windowHeight=window.innerHeight,this.windowWidth=window.innerWidth},mounted(){this.isMobile=this.windowWidth<=525,this.drawerHeight=this.getHeight,this.snap=this.drawerHeight,document.documentElement.style.overflow=1==this.modelValue?"hidden":"overlay",window.addEventListener("resize",this.handleResize)},beforeDestroy(){window.removeEventListener("resize",this.handleResize)}};const l={key:0,class:"header__title"},p=i("i",{class:"light-icon-x"},null,-1),c={class:"drawer-container__slot-content"};!function(e,t){void 0===t&&(t={});var r=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===r&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}(".lv-drawer__wrapper {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  height: 100%;\n  width: 100%;\n  overflow: hidden; }\n  .lv-drawer__wrapper .wrapper__drawer-container {\n    pointer-events: all;\n    position: absolute;\n    z-index: 10;\n    transition: all 0.3s ease;\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    margin: 0 !important;\n    max-width: 100vw !important; }\n    .lv-drawer__wrapper .wrapper__drawer-container::-webkit-scrollbar {\n      display: none; }\n    .lv-drawer__wrapper .wrapper__drawer-container .touch-dragger {\n      font-size: 30px;\n      text-align: center;\n      line-height: 20px;\n      position: relative;\n      height: max-content;\n      width: 100%;\n      position: sticky;\n      height: 15px;\n      top: 0; }\n      .lv-drawer__wrapper .wrapper__drawer-container .touch-dragger::before {\n        content: '';\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        transform: translateX(-50%);\n        background-color: rgba(0, 0, 0, 0.3);\n        height: 4px;\n        width: 45px;\n        border-radius: 50px;\n        overflow: hidden; }\n    .lv-drawer__wrapper .wrapper__drawer-container .drawer-container__header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      touch-action: none;\n      min-height: max-content; }\n      .lv-drawer__wrapper .wrapper__drawer-container .drawer-container__header .header__title {\n        padding: 10px; }\n      .lv-drawer__wrapper .wrapper__drawer-container .drawer-container__header .header__close {\n        cursor: pointer;\n        display: inline-block;\n        padding: 10px; }\n        .lv-drawer__wrapper .wrapper__drawer-container .drawer-container__header .header__close i {\n          font-size: 20px;\n          font-weight: 700; }\n          .lv-drawer__wrapper .wrapper__drawer-container .drawer-container__header .header__close i::before, .lv-drawer__wrapper .wrapper__drawer-container .drawer-container__header .header__close i::after {\n            vertical-align: initial; }\n    .lv-drawer__wrapper .wrapper__drawer-container .drawer-container__slot-content {\n      height: 100%;\n      overflow-y: auto; }\n      .lv-drawer__wrapper .wrapper__drawer-container .drawer-container__slot-content::-webkit-scrollbar {\n        display: none; }\n  .lv-drawer__wrapper.--close {\n    visibility: hidden; }\n  .lv-drawer__wrapper.--shadow .wrapper__drawer-container {\n    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.3); }\n  .lv-drawer__wrapper.--mobile .wrapper__drawer-container {\n    border-top-right-radius: 15px;\n    border-top-left-radius: 15px; }\n  .lv-drawer__wrapper.--moving .wrapper__drawer-container {\n    transition: none; }\n  .lv-drawer__wrapper.--absolute {\n    position: absolute; }\n  .lv-drawer__wrapper.--no-backdrop {\n    pointer-events: none; }\n  .lv-drawer__wrapper .wrapper__backdrop {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    min-height: 100vh;\n    min-width: 100vw;\n    background-color: black;\n    /* /backdrop-filter: blur(2px); */\n    /*  */ }\n"),s.render=function(e,t,s,w,u,g){return r(),n("div",{class:["lv-drawer__wrapper",{"--shadow":s.shadow,"--close":!e.modelValue,"--mobile":g.getDrawerPosition,"--moving":u.isMoving,"--absolute":s.absolute,"--no-backdrop":s.noBackdrop}],style:{zIndex:s.zIndex},ref:"drawerWrapper"},[i("aside",{class:"wrapper__drawer-container",style:g.getDrawerStyle,ref:"drawer"},[g.getDrawerPosition?(r(),n("div",{key:0,class:"touch-dragger",onTouchstart:t[1]||(t[1]=o(((...e)=>g.handleTouchStart&&g.handleTouchStart(...e)),["prevent"])),onTouchmove:t[2]||(t[2]=o(((...e)=>g.handleTouchMove&&g.handleTouchMove(...e)),["prevent"])),onTouchend:t[3]||(t[3]=o(((...e)=>g.handleTouchEnd&&g.handleTouchEnd(...e)),["prevent"]))},null,32)):a("",!0),s.headerTitle||s.close||e.$slots.customHeader?(r(),n("div",{key:1,class:"drawer-container__header",ref:"drawerHeader",style:g.getHeaderStyle},[e.$slots.customHeader?d(e.$slots,"customHeader",{key:1}):(r(),n("div",l,h(s.headerTitle),1)),s.close?(r(),n("div",{key:2,class:"header__close",onClick:t[4]||(t[4]=(...e)=>g.drawerClose&&g.drawerClose(...e))},[p])):a("",!0)],4)):a("",!0),i("div",c,[d(e.$slots,"default")])],4),s.noBackdrop?a("",!0):(r(),n("div",{key:0,class:"wrapper__backdrop",onClick:t[5]||(t[5]=(...e)=>g.drawerClose&&g.drawerClose(...e)),style:{zIndex:s.zIndex-1,backdropFilter:s.backdropBlur&&"blur(5px)",filter:`${s.backdropBlur?"blur(5px) ":""}opacity(${s.backdropOpacity})`}},null,4))],6)};export default s;

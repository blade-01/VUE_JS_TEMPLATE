"use strict";var e=require("lightvue/utils"),t=require("lightvue/mixins"),n=require("vue"),i={name:"LvOverlaypanel",mixins:[t.preventBrowserBackMixin],props:{dismissable:{type:Boolean,default:!0},showCloseIcon:{type:Boolean,default:!1},appendTo:{type:String,default:null},baseZIndex:{type:Number,default:0},autoZIndex:{type:Boolean,default:!0},ariaCloseLabel:{type:String,default:"close"},alignRight:{type:Boolean,default:!1},closeOnResize:{type:Boolean,default:!1}},data:()=>({visible:!1}),selfClick:!1,target:null,outsideClickListener:null,scrollHandler:null,resizeListener:null,beforeDestroy(){this.onBeforeUnmount()},beforeUnmount(){this.onBeforeUnmount()},methods:{handleOnBrowserBack(){!0===this.visible&&this.hide()},toggle(e,t){let n=e?e.currentTarget:t;this.visible?this.hide():this.show(n)},show(e){this.visible=!0,this.target=e,this.preventPopstate()},hide(){this.visible=!1,this.manuallyClosePopstate()},onContentClick(){this.selfClick=!0},onEnter(){this.appendContainer(),this.alignOverlay(),this.dismissable&&this.bindOutsideClickListener(),this.closeOnResize&&(this.bindScrollListener(),this.bindResizeListener()),this.autoZIndex&&(this.$refs.overlayRef.style.zIndex=String(this.baseZIndex+e.DomHandler.generateZIndex()))},onLeave(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener()},alignOverlay(){e.DomHandler.absolutePosition(this.$refs.overlayRef,this.target);const t=e.DomHandler.getOffset(this.$refs.overlayRef),n=e.DomHandler.getOffset(this.target);let i=0;if(t.left<n.left&&(i=n.left-t.left),this.$refs.overlayRef.style.setProperty("--overlay-arrow-left",`${i}px`),this.$refs.overlayRef.style.setProperty("--overlay-arrow-pos","calc(var(--overlay-arrow-left, 0) + 1.25rem)"),t.top<n.top&&e.DomHandler.addClass(this.$refs.overlayRef,"--flipped"),this.alignRight){let e=this.target.getBoundingClientRect().right-this.target.getBoundingClientRect().left,t=this.$refs.overlayRef.getBoundingClientRect().right-this.$refs.overlayRef.getBoundingClientRect().left;this.$refs.overlayRef.style.left=n.left-(t-e)+"px",this.$refs.overlayRef.style.setProperty("--overlay-arrow-pos","calc(100% - 40px)")}},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{!this.visible||this.selfClick||this.isTargetClicked(e)||this.hide(),this.selfClick=!1},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null,this.selfClick=!1)},bindScrollListener(){this.scrollHandler||(this.scrollHandler=new e.ConnectedOverlayScrollHandler(this.target,(()=>{this.visible&&this.hide()}))),this.scrollHandler.bindScrollListener()},unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.visible&&this.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},isTargetClicked(){return this.target&&(this.target===event.target||this.target.contains(event.target))},appendContainer(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.$refs.overlayRef):document.getElementById(this.appendTo).appendChild(this.$refs.overlayRef))},restoreAppend(){this.$refs.overlayRef&&this.appendTo&&("body"===this.appendTo?document.body.removeChild(this.$refs.overlayRef):document.getElementById(this.appendTo).removeChild(this.$refs.overlayRef))},onBeforeUnmount(){this.restoreAppend(),this.dismissable&&this.unbindOutsideClickListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.unbindResizeListener(),this.target=null}}};const l={key:0,class:"lv-overlaypanel lv-component",ref:"overlayRef"};!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css","top"===n&&i.firstChild?i.insertBefore(l,i.firstChild):i.appendChild(l),l.styleSheet?l.styleSheet.cssText=e:l.appendChild(document.createTextNode(e))}}(".lv-overlaypanel {\n  position: absolute;\n  margin-top: 10px; }\n  .lv-overlaypanel:after, .lv-overlaypanel:before {\n    /* Pointing Arrow */\n    position: absolute;\n    left: var(--overlay-arrow-pos);\n    bottom: 100%;\n    content: ' ';\n    height: 0;\n    width: 0;\n    pointer-events: none; }\n  .lv-overlaypanel.--flipped {\n    margin-top: 0;\n    margin-bottom: 10px; }\n    .lv-overlaypanel.--flipped:after, .lv-overlaypanel.--flipped:before {\n      bottom: auto;\n      top: 100%;\n      border-bottom-color: transparent; }\n  .lv-overlaypanel .lv-overlaypanel__close-btn {\n    position: absolute;\n    top: 0px;\n    right: 0px;\n    transform: translate(50%, -50%); }\n    .lv-overlaypanel .lv-overlaypanel__close-btn.--right-align {\n      transform: translate(-50%, -50%);\n      left: 0px; }\n\n/* Animation */\n.lv-overlaypanel__transition-enter-from {\n  opacity: 0;\n  transform: scaleY(0.8); }\n\n.lv-overlaypanel__transition-leave-to {\n  opacity: 0; }\n\n.lv-overlaypanel__transition-enter-active {\n  transition: transform 0.12s cubic-bezier(0, 0, 0.2, 1), opacity 0.12s cubic-bezier(0, 0, 0.2, 1); }\n\n.lv-overlaypanel__transition-leave-active {\n  transition: opacity 0.1s linear; }\n\n.lv-overlaypanel {\n  background: #ffffff;\n  border: 0 none;\n  border-radius: 4px;\n  box-shadow: 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12); }\n  .lv-overlaypanel:after, .lv-overlaypanel:before {\n    border: 10px solid transparent;\n    border-color: rgba(255, 255, 255, 0);\n    border-bottom-color: #ffffff; }\n  .lv-overlaypanel.--flipped:after, .lv-overlaypanel.--flipped:before {\n    border-top-color: #ffffff; }\n  .lv-overlaypanel .lv-overlaypanel__content {\n    padding: 1rem; }\n"),i.render=function(e,t,i,r,o,s){const a=n.resolveComponent("LvButton");return n.openBlock(),n.createBlock(n.Transition,{name:"lv-overlaypanel__transition",onEnter:s.onEnter,onLeave:s.onLeave},{default:n.withCtx((()=>[o.visible?(n.openBlock(),n.createBlock("div",l,[n.createVNode("div",{class:"lv-overlaypanel__content",onClick:t[1]||(t[1]=(...e)=>s.onContentClick&&s.onContentClick(...e))},[n.renderSlot(e.$slots,"default")]),i.showCloseIcon?(n.openBlock(),n.createBlock(a,{key:0,class:{"lv-overlaypanel__close-btn":!0,"--right-align":i.alignRight},icon:"light-icon-x",rounded:"",onClick:s.hide,"aria-label":i.ariaCloseLabel,type:"button"},null,8,["class","onClick","aria-label"])):n.createCommentVNode("",!0)],512)):n.createCommentVNode("",!0)])),_:1},8,["onEnter","onLeave"])},module.exports=i;
